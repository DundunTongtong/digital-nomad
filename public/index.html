<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>Digital Nomad</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body>
  <h1>Digital Nomad Jobs</h1>

  <div id="status">加载中…</div>
  <ul id="jobList"></ul>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const status = document.getElementById('status')
      const jobList = document.getElementById('jobList')

      try {
        const res = await fetch('/api/jobs')
        const data = await res.json()

        if (!Array.isArray(data)) {
          status.textContent = 'API 返回格式错误'
          console.error(data)
          return
        }

        status.textContent = `加载成功，共 ${data.length} 条`

        data.forEach(job => {
          const li = document.createElement('li')
          li.innerHTML = `
            <strong>${job.title}</strong>
            @ ${job.company}
            ${job.paid ? '⭐' : ''}
            <a href="${job.url}" target="_blank">查看</a>
          `
          jobList.appendChild(li)
        })
      } catch (err) {
        status.textContent = '加载失败，请查看控制台'
        console.error(err)
      }
    })
  </script>
</body>
</html>
